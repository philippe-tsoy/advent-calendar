import{a as j}from"./chunk-SK2CRI2C.js";import{$a as Y,Aa as A,Cb as P,Ea as M,Na as u,Oa as f,Qa as Q,Ra as G,Sa as F,Ta as S,Ua as T,V as C,Va as K,W as b,Wa as s,X as R,Xa as d,Y as H,Ya as I,Za as w,_a as O,ab as _,bb as c,cb as Z,da as l,db as ee,eb as te,fb as ne,gb as x,hb as V,ib as h,jb as E,kb as ie,pa as v,pb as m,qb as D,ra as r,sb as N,tb as g,ub as oe}from"./chunk-L7WXYAWM.js";function se(o,e){o&1&&(s(0,"div",4),h(1,"\u{1F512}"),d())}function de(o,e){if(o&1&&I(0,"img",5),o&2){let t=c();O("src",t.imageUrl(),v)("alt","Day "+(t.display()||t.day()))}}var L=class o{colors=["white","green","red"];randomColor;imageDelayTimer;showImage=l(!1);classString=m(()=>{let e=[];e.push("window"),e.push(`window--${this.randomColor}`);let t=this.state();return e.push(t),t!=="locked"&&e.push("clickable"),t==="opened"&&e.push("opened"),e.join(" ")});day=g.required();display=g("");isUnlocked=g.required();isOpened=g.required();imageUrl=g("");open=N();state=m(()=>this.isOpened()?"opened":this.isUnlocked()?"unlocked":"locked");hasValidImage=m(()=>{let e=this.imageUrl();return e&&e.trim()!==""});shouldShowImage=m(()=>!this.hasValidImage()||this.state()!=="opened"?!1:this.day()===32?this.showImage():!0);constructor(){let e=this.colors[Math.floor(Math.random()*this.colors.length)];e==="white"&&(e=Math.random()<.5?"red":"green"),this.randomColor=e,D(()=>{let t=this.isOpened(),n=this.day();n===32&&t?(this.imageDelayTimer&&clearTimeout(this.imageDelayTimer),this.showImage.set(!1),this.imageDelayTimer=window.setTimeout(()=>{this.showImage.set(!0)},1e4)):n!==32&&this.showImage.set(!0)})}ngOnDestroy(){this.imageDelayTimer&&clearTimeout(this.imageDelayTimer)}onClick(e){if(this.state()!=="locked"){let t=this.randomColor==="white"?"red":this.randomColor;this.open.emit({x:e.clientX,y:e.clientY,color:t})}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=M({type:o,selectors:[["app-window"]],inputs:{day:[1,"day"],display:[1,"display"],isUnlocked:[1,"isUnlocked"],isOpened:[1,"isOpened"],imageUrl:[1,"imageUrl"]},outputs:{open:"open"},decls:7,vars:7,consts:[[3,"click"],[1,"door"],[1,"door-front"],[1,"day-number"],[1,"lock-icon"],[1,"window-image",3,"src","alt"]],template:function(t,n){t&1&&(s(0,"div",0),_("click",function(a){return n.onClick(a)}),s(1,"div",1)(2,"div",2)(3,"span",3),h(4),d(),u(5,se,2,0,"div",4),d()(),u(6,de,1,2,"img",5),d()),t&2&&(V(n.classString()),r(),x("opened",n.state()==="opened"),r(3),E(n.display()||n.day()),r(),f(n.state()==="locked"?5:-1),r(),f(n.state()==="opened"&&n.hasValidImage()&&n.shouldShowImage()?6:-1))},dependencies:[P],styles:[".window--green[_ngcontent-%COMP%]   .door-front[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d4ffd695,#6eff6b9d,#2ecc408f)}.window--green[_ngcontent-%COMP%]   .door-front[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{color:#fff;text-shadow:none}.window--red[_ngcontent-%COMP%]   .door-front[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff8a9697,#ff6b9c9d,#ff4b5d97)}.window[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;background:transparent;border-radius:15px;display:flex;align-items:center;justify-content:center;cursor:pointer;border:3px dotted rgba(255,255,255,.439);position:relative;overflow:hidden;box-sizing:border-box;perspective:1000px}@media (max-width: 480px){.window[_ngcontent-%COMP%]{border-radius:10px;border-width:2px}}.window.locked[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.6;filter:grayscale(.3)}.window.opened[_ngcontent-%COMP%]{pointer-events:auto}.door[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:left center;transition:transform .8s cubic-bezier(.68,-.55,.265,1.55),visibility 0s linear .8s;z-index:3;border-radius:15px;overflow:hidden;backface-visibility:hidden}.door.opened[_ngcontent-%COMP%]{transform:rotateY(-120deg);pointer-events:none;visibility:hidden}.door-front[_ngcontent-%COMP%]{width:100%;height:100%;background:linear-gradient(135deg,#ff8a95,#ff6b9d,#ff8a95);border-radius:15px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.5rem;box-shadow:inset 0 0 20px #0000001a,0 4px 8px #0003;transition:box-shadow .3s ease;position:relative;backface-visibility:hidden;transform-style:preserve-3d}@media (max-width: 480px){.door-front[_ngcontent-%COMP%]{border-radius:10px;gap:.3rem}}.door-front[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#fff;text-shadow:0 2px 4px rgba(0,0,0,.3);z-index:1}@media (max-width: 768px){.door-front[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{font-size:1rem}}@media (max-width: 480px){.door-front[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{font-size:.9rem}}.door-front[_ngcontent-%COMP%]   .lock-icon[_ngcontent-%COMP%]{font-size:1.2rem;opacity:.8;y:.8;z-index:1}.window.opened[_ngcontent-%COMP%]   .window-content[_ngcontent-%COMP%]{opacity:1;z-index:4}.window-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:12px;opacity:0;transition:opacity .3s ease .8s;position:relative;z-index:1}@media (max-width: 480px){.window-image[_ngcontent-%COMP%]{border-radius:8px}}.window.opened[_ngcontent-%COMP%]   .window-image[_ngcontent-%COMP%]{opacity:1}.day-number[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#5a5a5a;text-shadow:0 2px 4px rgba(255,255,255,.5);display:block;width:100%;text-align:center}@media (max-width: 768px){.day-number[_ngcontent-%COMP%]{font-size:1.5rem}}@media (max-width: 480px){.day-number[_ngcontent-%COMP%]{font-size:1.2rem}}.opened-indicator[_ngcontent-%COMP%]{font-size:1.5rem;animation:_ngcontent-%COMP%_sparkle 1.5s ease-in-out infinite}@keyframes _ngcontent-%COMP%_sparkle{0%,to{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.2)}}"],changeDetection:0})};var le=["popupContent"];function ce(o,e){if(o&1){let t=w();s(0,"div",2),_("click",function(i){C(t);let a=c();return b(a.onOverlayClick(i))}),s(1,"div",3,0)(3,"button",4),_("click",function(){C(t);let i=c();return b(i.onClose())}),h(4,"\xD7"),d(),s(5,"div")(6,"div",5),I(7,"img",6),d(),s(8,"div",7),h(9),d()()()()}if(o&2){let t=c();r(),ne("--origin-x",t.originX||"50vw")("--origin-y",t.originY||"50vh"),r(2),V(t.buttonClass()),r(2),V(t.contentContainerClass()),r(2),O("src",t.imagePath(),v)("alt","Day "+t.message()),r(2),E(t.message())}}var B=class o{visible=g.required();message=g.required();imagePath=g.required();originX=g();originY=g();doorColor=g();contentContainerClass=m(()=>{let e="popup-content-container",t=this.doorColor();return t==="red"?`${e} popup-content-container--red`:t==="green"?`${e} popup-content-container--green`:e});buttonClass=m(()=>{let e="close-button",t=this.doorColor();return t==="red"?`${e} close-button--green`:t==="green"?`${e} close-button--red`:e});popupContent;animationEasing="cubic-bezier(0.22, 1, 0.36, 1)";constructor(){D(()=>{let e=this.visible&&this.visible();setTimeout(e?()=>this.animateFromOrigin():()=>this.resetAnimationStyles(),0)})}close=N();onClose(){this.close.emit()}onOverlayClick(e){e.target===e.currentTarget&&this.onClose()}animateFromOrigin(){try{let e=this.popupContent?.nativeElement;if(!e)return;let i=10/(e.offsetWidth||e.getBoundingClientRect().width||300);i<=0&&(i=.01),i>1&&(i=1),e.style.transformOrigin="50% 50%",e.style.transition="none",e.style.transform=`scale(${i}) rotate(-720deg)`,e.style.opacity="0",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`transform 1.2s ${this.animationEasing}, opacity 0.6s ease`,e.style.transform="scale(1) rotate(0deg)",e.style.opacity="1"})})}catch{}}resetAnimationStyles(){try{let e=this.popupContent?.nativeElement;if(!e)return;e.style.transition="",e.style.transform="",e.style.opacity=""}catch{}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=M({type:o,selectors:[["app-popup"]],viewQuery:function(t,n){if(t&1&&Z(le,5),t&2){let i;ee(i=te())&&(n.popupContent=i.first)}},hostVars:4,hostBindings:function(t,n){t&2&&x("visible",n.visible())("hidden",!n.visible())},inputs:{visible:[1,"visible"],message:[1,"message"],imagePath:[1,"imagePath"],originX:[1,"originX"],originY:[1,"originY"],doorColor:[1,"doorColor"]},outputs:{close:"close"},decls:1,vars:1,consts:[["popupContent",""],[1,"popup-overlay"],[1,"popup-overlay",3,"click"],[1,"popup-content"],["aria-label","Close popup",3,"click"],[1,"popup-image-container"],[1,"popup-image",3,"src","alt"],[1,"popup-message"]],template:function(t,n){t&1&&u(0,ce,10,11,"div",1),t&2&&f(n.visible()?0:-1)},dependencies:[P],styles:[".popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:transparent;display:flex;justify-content:center;align-items:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.popup-content[_ngcontent-%COMP%]{position:relative;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:12px;width:fit-content;min-width:525px;max-width:90vw;max-height:95vh;overflow-y:auto;transform-origin:50% 50%;animation:_ngcontent-%COMP%_popupGrow .6s ease-out forwards}.close-button[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;background:#fff;color:#ff6b9d;border:none;border-radius:50%;width:2.5rem;height:2.5rem;font-size:1.5rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease;z-index:10;box-shadow:0 2px 8px #0003}.close-button[_ngcontent-%COMP%]:hover{background:#f5f5f5;transform:scale(1.1)}.close-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.close-button--red[_ngcontent-%COMP%]{background:#fff;color:#ff6b9d}.close-button--red[_ngcontent-%COMP%]:hover{background:#f5f5f5}.close-button--green[_ngcontent-%COMP%]{background:#fff;color:#6eff6b}.close-button--green[_ngcontent-%COMP%]:hover{background:#f5f5f5}.popup-image-container[_ngcontent-%COMP%]{width:fit-content;max-width:350px;margin:0 auto;border-radius:15px;overflow:hidden;box-shadow:0 4px 15px #0003}.popup-image[_ngcontent-%COMP%]{width:350px;height:350px;display:block;object-fit:cover;margin:0 auto}.popup-content-container[_ngcontent-%COMP%]{border-radius:8px;padding:1rem}.popup-content-container.popup-content-container--red[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff8a968c,#ff6b9c8c,#ff4b5d8c);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.popup-content-container.popup-content-container--green[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d4ffd68c,#6eff6b8c,#2ecc408c);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.popup-message[_ngcontent-%COMP%]{text-align:center;font-size:1.25rem;color:#fff;font-weight:500;line-height:1.6;margin:1rem 0 0;white-space:pre-line;width:auto;min-width:350px;max-width:600px;word-wrap:break-word;overflow-wrap:break-word;box-sizing:border-box;-webkit-font-smoothing:antialiased;text-shadow:1px 1px 2px rgba(0,0,0,.8)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_popupGrow{0%{transform:scale(.05) rotate(-180deg);opacity:0}to{transform:scale(1) rotate(0);opacity:1}}@media screen and (max-width: 768px){[_nghost-%COMP%]   .popup-content[_ngcontent-%COMP%]{padding:1rem;min-width:300px;max-width:95vw;max-height:95vh}[_nghost-%COMP%]   .popup-image-container[_ngcontent-%COMP%]{max-width:300px;margin:0 auto;border-radius:12px}[_nghost-%COMP%]   .popup-image[_ngcontent-%COMP%]{width:300px;height:300px}[_nghost-%COMP%]   .popup-content-container[_ngcontent-%COMP%]{padding:.75rem}[_nghost-%COMP%]   .popup-message[_ngcontent-%COMP%]{font-size:1.1rem;margin:1rem 0 0;min-width:auto;max-width:calc(95vw - 2rem);width:100%}}@media screen and (max-width: 480px){[_nghost-%COMP%]   .popup-content[_ngcontent-%COMP%]{padding:.75rem;min-width:250px;border-radius:8px}[_nghost-%COMP%]   .close-button[_ngcontent-%COMP%]{width:2rem;height:2rem;font-size:1.2rem;top:.5rem;right:.5rem}[_nghost-%COMP%]   .popup-image-container[_ngcontent-%COMP%]{max-width:250px;margin:0 auto;border-radius:8px}[_nghost-%COMP%]   .popup-image[_ngcontent-%COMP%]{width:250px;height:250px}[_nghost-%COMP%]   .popup-content-container[_ngcontent-%COMP%]{padding:.5rem}[_nghost-%COMP%]   .popup-message[_ngcontent-%COMP%]{font-size:.95rem;line-height:1.5;margin:.75rem 0 0;min-width:auto;max-width:calc(95vw - 1.5rem);width:100%}}"],changeDetection:0})};function me(o,e){o&1&&(s(0,"div",7),h(1,"Happy New Year my love!"),d())}function ge(o,e){if(o&1){let t=w();s(0,"img",13),_("error",function(i){return C(t),b(i.target.style.display="none")}),d()}if(o&2){let t,n=c(3);O("src",n.rightImagePath(),v)("alt","Day "+((t=n.currentDay())==null?null:t.day)+" screenshot")}}function ue(o,e){if(o&1){let t=w();s(0,"div",9)(1,"div",11)(2,"div",12)(3,"img",13),_("error",function(i){return C(t),b(i.target.style.display="none")}),d()(),s(4,"div",14)(5,"div",15),h(6),d()()(),s(7,"div",16)(8,"div",12),u(9,ge,1,2,"img",17),d()()()}if(o&2){let t,n=c(2);r(3),O("src",n.leftImagePath(),v)("alt","Day "+((t=n.currentDay())==null?null:t.day)),r(3),E(n.currentMessage()),r(3),f(n.rightImagePath()?9:-1)}}function fe(o,e){if(o&1){let t=w();s(0,"div",18)(1,"div",12)(2,"img",19),_("error",function(i){return C(t),b(i.target.style.display="none")}),d()()()}if(o&2){let t=c(2);x("hidden-during-message",t.showNewYearMessage()),r(2),O("src",t.leftImagePath(),v)}}function he(o,e){if(o&1){let t=w();s(0,"div",1)(1,"button",2),_("click",function(){C(t);let i=c();return b(i.close.emit())}),R(),s(2,"svg",3),I(3,"line",4)(4,"line",5),d()(),H(),s(5,"div",6),u(6,me,2,0,"div",7),s(7,"div",8),h(8),d(),u(9,ue,10,4,"div",9)(10,fe,3,3,"div",10),d()()}if(o&2){let t=c();x("fade-to-black-overlay",t.isFadingToBlack()||t.isShowingDay32()),r(5),x("fade-to-black",t.isFadingToBlack())("fade-in-day32",t.isShowingDay32()&&!t.isFadingToBlack()),r(),f(t.showNewYearMessage()?6:-1),r(),x("fade-transition",t.isTitleTransitioning())("hidden-during-message",t.showNewYearMessage()),r(),ie(" ",t.currentDate()," "),r(),f(t.showSplitScreen()?9:10)}}var $=class o{constructor(e){this.calendarDataService=e;this.allDays=Array.from({length:31},(t,n)=>this.calendarDataService.getDayData(n+1)),this.transitionTimings=[1.4,1.22,1.06,.91,.78,.66,.55,.46,.38,.3,.23,.21,.2,.2,.19,.19,.19,.19,.19,.2,.2,.21,.22,.23,.24,.3,.38,.48,.6,.75],D(()=>{this.visible()?this.startAnimation():this.stopAnimation()})}visible=g.required();close=N();animationTimer;currentIndex=0;animationStartTime;currentDayIndex=l(0);isShowingDay32=l(!1);isTitleTransitioning=l(!1);isFadingToBlack=l(!1);showNewYearMessage=l(!1);allDays=[];transitionTimings=[];currentDay=m(()=>{let e=this.currentDayIndex();return e<this.allDays.length?this.allDays[e]:null});currentDate=m(()=>{if(this.isShowingDay32())return this.formatDate(new Date(2026,0,1));let e=this.currentDay();return e?this.formatDateForDay(e.day):""});leftImagePath=m(()=>{let e=this.currentDay();return this.isShowingDay32()?"assets/images/day-32.jpg":e?this.calendarDataService.getImageUrl(e):""});rightImagePath=m(()=>{if(this.isShowingDay32())return"";let e=this.currentDay();return e?e.imagePath.replace(/\.jpg$/,"-sc.png"):""});currentMessage=m(()=>this.isShowingDay32()?"":this.currentDay()?.message||"");showSplitScreen=m(()=>!this.isShowingDay32());ngOnInit(){this.preloadImages()}ngOnDestroy(){this.stopAnimation()}preloadImages(){for(let e=1;e<=32;e++){let t=this.calendarDataService.getDayData(e),n=this.calendarDataService.getImageUrl(t);if(n&&!n.startsWith("data:")){let i=new Image;i.src=n}if(e<=31){let i=n.replace(/\.jpg$/,"-sc.jpg");if(i&&!i.startsWith("data:")){let a=new Image;a.src=i}}}}startAnimation(){this.stopAnimation(),this.animationStartTime=Date.now(),this.currentIndex=0,this.currentDayIndex.set(0),this.isShowingDay32.set(!1),this.isTitleTransitioning.set(!1),this.isFadingToBlack.set(!1),this.showNewYearMessage.set(!1),this.animationTimer=window.setTimeout(()=>{this.playSlideshow()},3e3)}stopAnimation(){this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=void 0)}playSlideshow(){if(this.currentIndex>=this.transitionTimings.length){this.animationTimer=window.setTimeout(()=>{this.isFadingToBlack.set(!0),this.animationTimer=window.setTimeout(()=>{let e=this.animationStartTime?Date.now()-this.animationStartTime:0,t=Math.max(0,1e4-e);this.animationTimer=window.setTimeout(()=>{this.isFadingToBlack.set(!1),this.showNewYearMessage.set(!0),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.isShowingDay32.set(!0)})}),this.animationTimer=window.setTimeout(()=>{this.showNewYearMessage.set(!1)},5e3)},t)},2e3)},1500);return}this.animationTimer=window.setTimeout(()=>{this.currentIndex++,this.currentDayIndex.set(this.currentIndex),this.animationTimer=window.setTimeout(()=>{this.playSlideshow()},80)},this.transitionTimings[this.currentIndex]*1e3)}generateTransitionTimings(e=31,t=15,n=.18,i=.75,a=80){let p=e-1,y=[];for(let k=0;k<p;k++){let X=k/(p-1),re=.5-.5*Math.cos(Math.PI*X);y.push(i-re*(i-n))}let W=y.reduce((k,X)=>k+X,0),z=(e-1)*a/1e3,U=(t-z)/W;return y.map(k=>k*U)}formatDateForDay(e){let i=new Date(2025,11,e);return this.formatDate(i)}formatDate(e){let t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=e.getDate(),i=t[e.getMonth()],a=e.getFullYear(),p=this.getOrdinalSuffix(n);return`${i} ${n}${p} ${a}`}getOrdinalSuffix(e){if(e>=11&&e<=13)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}static \u0275fac=function(t){return new(t||o)(A(j))};static \u0275cmp=M({type:o,selectors:[["app-day32-animation"]],inputs:{visible:[1,"visible"]},outputs:{close:"close"},decls:1,vars:1,consts:[[1,"animation-overlay",3,"fade-to-black-overlay"],[1,"animation-overlay"],["aria-label","Close animation",1,"close-button",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"animation-container"],[1,"new-year-message"],[1,"animation-title"],[1,"split-screen"],[1,"full-screen-day32",3,"hidden-during-message"],[1,"left-panel"],[1,"image-container"],[1,"day-image",3,"error","src","alt"],[1,"message-container"],[1,"message-text"],[1,"right-panel"],[1,"day-image",3,"src","alt"],[1,"full-screen-day32"],["alt","Day 32",1,"day-image","day32-image",3,"error","src"]],template:function(t,n){t&1&&u(0,he,11,13,"div",0),t&2&&f(n.visible()?0:-1)},dependencies:[P],styles:[".animation-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000;z-index:2000;display:flex;justify-content:center;align-items:center;pointer-events:auto;overflow:hidden;animation:_ngcontent-%COMP%_fadeToBlack 3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeToBlack{0%{background-color:#0000}to{background-color:#000}}.animation-overlay.fade-to-black-overlay[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeToFullyBlack 1s ease-in-out forwards;background-color:#000}@keyframes _ngcontent-%COMP%_fadeToFullyBlack{0%{background-color:#000}to{background-color:#000}}.animation-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;position:relative;opacity:0;animation:_ngcontent-%COMP%_fadeInContent .5s ease-in-out 3s forwards}@keyframes _ngcontent-%COMP%_fadeInContent{0%{opacity:0}to{opacity:1}}.animation-container.fade-to-black[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeToBlackContent 1s ease-in-out forwards}@keyframes _ngcontent-%COMP%_fadeToBlackContent{0%{opacity:1}to{opacity:0}}.animation-container.fade-in-day32[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInDay32 1s ease-in-out forwards}@keyframes _ngcontent-%COMP%_fadeInDay32{0%{opacity:0}to{opacity:1}}.new-year-message[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#6eff6b;font-size:3rem;font-weight:600;text-align:center;z-index:100;text-shadow:2px 2px 4px rgba(0,0,0,.8);animation:_ngcontent-%COMP%_fadeInOutMessage 5s ease-in-out forwards;white-space:nowrap}@keyframes _ngcontent-%COMP%_fadeInOutMessage{0%{opacity:0}20%{opacity:1}80%{opacity:1}to{opacity:0}}.hidden-during-message[_ngcontent-%COMP%]{opacity:0!important;transition:opacity 1s ease-in-out}.full-screen-day32[_ngcontent-%COMP%]:not(.hidden-during-message){animation:_ngcontent-%COMP%_fadeInDay32 1s ease-in-out forwards}.animation-title[_ngcontent-%COMP%]:not(.hidden-during-message){transition:opacity 1s ease-in-out}.new-year-message[_ngcontent-%COMP%] ~ .animation-title[_ngcontent-%COMP%]{opacity:0!important}.close-button[_ngcontent-%COMP%]{position:absolute;top:1.5rem;right:1.5rem;z-index:3000;background:#00000080;border:2px solid rgba(255,255,255,.3);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#fff;transition:all .3s ease;opacity:0;animation:_ngcontent-%COMP%_fadeInContent .5s ease-in-out 3s forwards}.close-button[_ngcontent-%COMP%]:hover{background:#000000b3;border-color:#ffffff80;transform:scale(1.1)}.close-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.close-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.animation-title[_ngcontent-%COMP%]{position:absolute;top:2rem;left:50%;transform:translate(-50%);color:#6eff6b;font-size:2.5rem;font-weight:600;text-align:center;z-index:10;text-shadow:2px 2px 4px rgba(0,0,0,.8);transition:opacity .5s ease-in-out}.animation-title.fade-transition[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInOut .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeInOut{0%,to{opacity:1}50%{opacity:0}}.split-screen[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;padding-top:6rem}.left-panel[_ngcontent-%COMP%], .right-panel[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;gap:2rem}.left-panel[_ngcontent-%COMP%]{border-right:2px solid rgba(255,255,255,.1)}.image-container[_ngcontent-%COMP%]{width:100%;max-width:100%;height:auto;display:flex;align-items:center;justify-content:center;overflow:hidden}.day-image[_ngcontent-%COMP%]{width:100%;height:auto;object-fit:contain;max-height:calc(100vh - 12rem);aspect-ratio:1008/2244;display:block}.day32-image[_ngcontent-%COMP%]{max-height:calc(100vh - 8rem)}.message-container[_ngcontent-%COMP%]{width:100%;max-width:90%;padding:1.5rem;background:linear-gradient(135deg,#ff8a968c,#ff6b9c8c,#ff4b5d8c);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);border-radius:12px;box-shadow:0 4px 15px #0000004d}.message-text[_ngcontent-%COMP%]{text-align:center;font-size:1.25rem;color:#fff;font-weight:500;line-height:1.6;white-space:pre-line;word-wrap:break-word;overflow-wrap:break-word;text-shadow:1px 1px 2px rgba(0,0,0,.8);-webkit-font-smoothing:antialiased}.full-screen-day32[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding-top:6rem;padding:6rem 2rem 2rem}@media screen and (max-width: 768px){.animation-title[_ngcontent-%COMP%]{font-size:2rem;top:1.5rem}.split-screen[_ngcontent-%COMP%]{flex-direction:column;padding-top:5rem}.left-panel[_ngcontent-%COMP%]{border-right:none;border-bottom:2px solid rgba(255,255,255,.1);flex:1}.right-panel[_ngcontent-%COMP%]{flex:1}.day-image[_ngcontent-%COMP%]{max-height:calc(50vh - 6rem)}.day32-image[_ngcontent-%COMP%]{max-height:calc(100vh - 6rem)}.message-container[_ngcontent-%COMP%]{padding:1rem}.message-text[_ngcontent-%COMP%]{font-size:1.1rem}}@media screen and (max-width: 480px){.animation-title[_ngcontent-%COMP%]{font-size:1.5rem;top:1rem}.left-panel[_ngcontent-%COMP%], .right-panel[_ngcontent-%COMP%]{padding:1rem;gap:1rem}.message-container[_ngcontent-%COMP%]{padding:.75rem}.message-text[_ngcontent-%COMP%]{font-size:.95rem;line-height:1.5}}"],changeDetection:0})};var ye=(o,e)=>e.day;function Ce(o,e){if(o&1){let t=w();S(0,"app-window",9),Y("open",function(i){let a=C(t).$implicit,p=c();return b(p.onWindowOpen(a.day,i))}),T()}if(o&2){let t=e.$implicit,n=c();F("day",t.day)("display",t.display)("isUnlocked",n.isUnlocked(t.day))("isOpened",n.isOpened(t.day))("imageUrl",n.getImageUrl(t))}}function be(o,e){if(o&1){let t=w();S(0,"app-popup",10),Y("close",function(){C(t);let i=c();return b(i.onPopupClose())}),T()}if(o&2){let t=e,n=c();F("visible",n.popupVisible())("message",t.message)("imagePath",n.getImageUrl(t))("originX",n.popupOriginX())("originY",n.popupOriginY())("doorColor",n.popupDoorColor())}}var ae=class o{constructor(e,t){this.calendarDataService=e;this.cdr=t;this.loadOpenedDays(),this.refreshCalendarData(),D(()=>{let n=this.openedDays();n.size>0?localStorage.setItem("advent-calendar-opened",JSON.stringify(Array.from(n))):localStorage.removeItem("advent-calendar-opened")})}storageListener;dataUpdateListener;calendarDays=l([]);openedDays=l(new Set);selectedDay=l(null);popupVisible=l(!1);popupOriginX=l(null);popupOriginY=l(null);popupDoorColor=l(null);day32AnimationVisible=l(!1);ngOnInit(){this.storageListener=e=>{e.key==="advent-calendar-custom-data"&&(this.refreshCalendarData(),this.cdr.markForCheck())},window.addEventListener("storage",this.storageListener),this.dataUpdateListener=()=>{this.refreshCalendarData(),this.cdr.markForCheck()},window.addEventListener("calendar-data-updated",this.dataUpdateListener)}ngOnDestroy(){this.storageListener&&window.removeEventListener("storage",this.storageListener),this.dataUpdateListener&&window.removeEventListener("calendar-data-updated",this.dataUpdateListener)}refreshCalendarData(){let e=this.calendarDataService.getAllDays(),t=e.slice(-4),n=this.shuffleDays(e.slice(0,-4)),i=[],a=4,p=8,y=0,W=0;for(let z=0;z<p;z++)for(let U=0;U<a;U++)z===7?i.push(t[W++]):y<n.length&&i.push(n[y++]);this.calendarDays.set(i)}shuffleDays(e){let t="advent-calendar-shuffle-order",n=localStorage.getItem(t),i;if(n)try{i=JSON.parse(n),i.length!==e.length&&(i=this.generateShuffleOrder(e.length),localStorage.setItem(t,JSON.stringify(i)))}catch{i=this.generateShuffleOrder(e.length),localStorage.setItem(t,JSON.stringify(i))}else i=this.generateShuffleOrder(e.length),localStorage.setItem(t,JSON.stringify(i));return i.map(a=>e[a])}generateShuffleOrder(e){let n=12345,i=()=>(n=(n*9301+49297)%233280,n/233280),a=Array.from({length:e},(p,y)=>y);for(let p=a.length-1;p>0;p--){let y=Math.floor(i()*(p+1));[a[p],a[y]]=[a[y],a[p]]}return a}loadOpenedDays(){let e=localStorage.getItem("advent-calendar-opened");if(e)try{let n=JSON.parse(e).map(i=>typeof i=="number"?i:Number(i)).filter(i=>!Number.isNaN(i));this.openedDays.set(new Set(n))}catch{this.openedDays.set(new Set)}}isUnlocked(e){return!0}isOpened(e){return this.openedDays().has(e)}onWindowOpen(e,t){if(e===32){if(!this.openedDays().has(e)){let a=new Set(this.openedDays());a.add(e),this.openedDays.set(a)}this.day32AnimationVisible.set(!0);return}let n=this.calendarDataService.getDayData(e);if(n){let i=this.openedDays().has(e);if(!i){let a=new Set(this.openedDays());a.add(e),this.openedDays.set(a)}this.selectedDay.set(n),t?(this.popupOriginX.set(`${t.x}px`),this.popupOriginY.set(`${t.y}px`),t.color&&this.popupDoorColor.set(t.color)):(this.popupOriginX.set(null),this.popupOriginY.set(null),this.popupDoorColor.set(null)),i?this.popupVisible.set(!0):setTimeout(()=>this.popupVisible.set(!0),900)}}onPopupClose(){this.popupVisible.set(!1),this.selectedDay.set(null),this.popupDoorColor.set(null)}onDay32AnimationClose(){this.day32AnimationVisible.set(!1)}getImageUrl(e){return this.calendarDataService.getImageUrl(e)}resetOpenedDays(){this.openedDays.set(new Set),localStorage.removeItem("advent-calendar-opened"),this.popupVisible.set(!1),this.selectedDay.set(null),this.popupDoorColor.set(null)}static \u0275fac=function(t){return new(t||o)(A(j),A(oe))};static \u0275cmp=M({type:o,selectors:[["app-calendar"]],decls:11,vars:2,consts:[[1,"calendar-container"],[1,"background-image"],[1,"calendar-content"],[1,"calendar-header"],[1,"gradient-text"],[1,"windows-grid"],[3,"day","display","isUnlocked","isOpened","imageUrl"],[3,"visible","message","imagePath","originX","originY","doorColor"],[3,"close","visible"],[3,"open","day","display","isUnlocked","isOpened","imageUrl"],[3,"close","visible","message","imagePath","originX","originY","doorColor"]],template:function(t,n){if(t&1&&(S(0,"div",0),K(1,"div",1),S(2,"div",2)(3,"div",3)(4,"h1",4),h(5,"Advent Calendar 2025"),T()(),S(6,"div",5),Q(7,Ce,1,5,"app-window",6,ye),T()(),u(9,be,1,6,"app-popup",7),S(10,"app-day32-animation",8),Y("close",function(){return n.onDay32AnimationClose()}),T()()),t&2){let i;r(7),G(n.calendarDays()),r(2),f((i=n.selectedDay())?9:-1,i),r(),F("visible",n.day32AnimationVisible())}},dependencies:[P,L,B,$],styles:['.calendar-container[_ngcontent-%COMP%]{position:relative;min-height:100vh;width:100%;overflow-x:hidden}.background-image[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-image:url("/advent-calendar/media/bg-img-Q5KUOFSK.jpg");background-size:cover;background-position:center;background-repeat:no-repeat;z-index:0;filter:brightness(.85) blur(2px)}.background-image[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#ffb6c14d,#ffdab94d)}.calendar-content[_ngcontent-%COMP%]{position:relative;z-index:1;padding:2rem 1rem;max-width:1400px;margin:0 auto}@media screen and (max-width: 768px){.calendar-content[_ngcontent-%COMP%]{padding:1.5rem .75rem}}@media screen and (max-width: 480px){.calendar-content[_ngcontent-%COMP%]{padding:1rem .5rem}}.calendar-header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem}@media screen and (max-width: 480px){.calendar-header[_ngcontent-%COMP%]{margin-bottom:1.5rem;gap:.75rem}}.gradient-text[_ngcontent-%COMP%]{font-size:48px;font-weight:700;text-align:center;background:linear-gradient(90deg,#fff,#2da82d,#fff,#ff2020,#fff);background-size:300% 100%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:2px 2px 8px rgba(255,255,255,.5);animation:_ngcontent-%COMP%_gradientShift 30s linear infinite}@media screen and (max-width: 768px){.gradient-text[_ngcontent-%COMP%]{font-size:32px}}@media screen and (max-width: 480px){.gradient-text[_ngcontent-%COMP%]{font-size:24px}}@keyframes _ngcontent-%COMP%_gradientShift{0%{background-position:0% 50%}to{background-position:300% 50%}}.admin-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-size:1.2rem;padding:.75rem 1.5rem;background:#fff3;border-radius:10px;transition:all .3s ease;border:2px solid rgba(255,255,255,.3);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);white-space:nowrap}.admin-link[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:translateY(-2px);box-shadow:0 5px 15px #0003}.reset-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:#ff6b9dcc;border:2px solid rgba(255,255,255,.3);border-radius:10px;color:#fff;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all .3s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:0 4px 8px #0003;white-space:nowrap}.reset-button[_ngcontent-%COMP%]:hover{background:#ff6b9d;transform:translateY(-2px);box-shadow:0 6px 12px #0000004d}.reset-button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 4px #0003}.reset-button[_ngcontent-%COMP%]   .reset-icon[_ngcontent-%COMP%]{font-size:1.2rem;display:inline-block;transition:transform .3s ease}.reset-button[_ngcontent-%COMP%]:hover   .reset-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.reset-button[_ngcontent-%COMP%]   .reset-text[_ngcontent-%COMP%]{font-family:inherit}@keyframes _ngcontent-%COMP%_titleGlow{0%,to{filter:drop-shadow(0 0 10px rgba(255,107,157,.5))}50%{filter:drop-shadow(0 0 20px rgba(255,107,157,.8))}}.windows-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(8,1fr);grid-template-rows:repeat(4,1fr);grid-auto-flow:column;gap:1rem;padding:1rem;justify-items:stretch;align-items:stretch}.windows-grid[_ngcontent-%COMP%]   app-window[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;box-sizing:border-box}@media screen and (max-width: 1024px){.windows-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr);grid-template-rows:repeat(8,1fr);grid-auto-flow:column;gap:.75rem;padding:.75rem}}@media screen and (max-width: 480px){.windows-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);grid-template-rows:repeat(16,1fr);grid-auto-flow:column;gap:.4rem;padding:.4rem}}'],changeDetection:0})};export{ae as CalendarComponent};
