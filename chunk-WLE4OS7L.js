import{a as J}from"./chunk-A7YQMK67.js";import{$a as p,Ab as _,Ca as C,La as u,Ma as h,Oa as T,Pa as F,Qa as V,Ra as w,Sa as v,Ta as W,Ua as c,V as y,Va as g,W as b,Wa as M,Xa as x,Ya as P,Za as L,_a as D,ab as X,ba as f,bb as j,cb as A,db as q,eb as k,fb as R,gb as m,hb as S,na as O,nb as E,ob as N,pa as s,qb as U,rb as d,sb as $,ya as Y}from"./chunk-VX6IEPVJ.js";function H(a,e){a&1&&(c(0,"div",4),m(1,"\u{1F512}"),g())}function K(a,e){if(a&1&&M(0,"img",5),a&2){let t=p();P("src",t.imageUrl(),O)("alt","Day "+(t.display()||t.day()))}}var z=class a{colors=["white","green","red"];randomColor;constructor(){let e=this.colors[Math.floor(Math.random()*this.colors.length)];e==="white"&&(e=Math.random()<.5?"red":"green"),this.randomColor=e}classString=E(()=>{let e=[];e.push("window"),e.push(`window--${this.randomColor}`);let t=this.state();return e.push(t),t!=="locked"&&e.push("clickable"),t==="opened"&&e.push("opened"),e.join(" ")});day=d.required();display=d("");isUnlocked=d.required();isOpened=d.required();imageUrl=d("");open=U();state=E(()=>this.isOpened()?"opened":this.isUnlocked()?"unlocked":"locked");hasValidImage=E(()=>{let e=this.imageUrl();return e&&e.trim()!==""});onClick(e){this.state()!=="locked"&&this.open.emit({x:e.clientX,y:e.clientY})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=C({type:a,selectors:[["app-window"]],inputs:{day:[1,"day"],display:[1,"display"],isUnlocked:[1,"isUnlocked"],isOpened:[1,"isOpened"],imageUrl:[1,"imageUrl"]},outputs:{open:"open"},decls:7,vars:7,consts:[[3,"click"],[1,"door"],[1,"door-front"],[1,"day-number"],[1,"lock-icon"],[1,"window-image",3,"src","alt"]],template:function(t,n){t&1&&(c(0,"div",0),D("click",function(i){return n.onClick(i)}),c(1,"div",1)(2,"div",2)(3,"span",3),m(4),g(),u(5,H,2,0,"div",4),g()(),u(6,K,1,2,"img",5),g()),t&2&&(R(n.classString()),s(),k("opened",n.state()==="opened"),s(3),S(n.display()||n.day()),s(),h(n.state()==="locked"?5:-1),s(),h(n.state()==="opened"&&n.hasValidImage()?6:-1))},dependencies:[_],styles:[".window--green[_ngcontent-%COMP%]{background-color:#6eff6b86;border-color:#2ecc40;--window-text-color: #ffffff}.window--red[_ngcontent-%COMP%]{background-color:#ff8a9685;border-color:#ff6b6b;--window-text-color: #ffffff}.window--green[_ngcontent-%COMP%]   .door-front[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d4ffd67c,#6eff6b83,#2ecc4075)}.window--green[_ngcontent-%COMP%]   .door-front[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{color:#fff;text-shadow:none}.window--red[_ngcontent-%COMP%]   .door-front[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff8a967e,#ff6b9c7e,#ff4b5d7e)}.window[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;background:transparent;border-radius:15px;display:flex;align-items:center;justify-content:center;cursor:pointer;border:3px dotted rgba(255,255,255,.4392156863);position:relative;overflow:hidden;box-sizing:border-box;perspective:1000px}.window.locked[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.6;filter:grayscale(.3)}.window.opened[_ngcontent-%COMP%]{pointer-events:auto}.door[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:left center;transition:transform .8s cubic-bezier(.68,-.55,.265,1.55),visibility 0s linear .8s;z-index:3;border-radius:15px;overflow:hidden;backface-visibility:hidden}.door.opened[_ngcontent-%COMP%]{transform:rotateY(-120deg);pointer-events:none;visibility:hidden}.door-front[_ngcontent-%COMP%]{width:100%;height:100%;background:linear-gradient(135deg,#ff8a95,#ff6b9d,#ff8a95);border-radius:15px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.5rem;box-shadow:inset 0 0 20px #0000001a,0 4px 8px #0003;transition:box-shadow .3s ease;position:relative;backface-visibility:hidden;transform-style:preserve-3d}.door-front[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#fff;text-shadow:0 2px 4px rgba(0,0,0,.3);z-index:1}.door-front[_ngcontent-%COMP%]   .lock-icon[_ngcontent-%COMP%]{font-size:1.2rem;opacity:.8;z-index:1}.window.opened[_ngcontent-%COMP%]   .window-content[_ngcontent-%COMP%]{opacity:1;z-index:4}.window-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:12px}.day-number[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#5a5a5a;text-shadow:0 2px 4px rgba(255,255,255,.5);display:block;width:100%;text-align:center}.opened-indicator[_ngcontent-%COMP%]{font-size:1.5rem;animation:_ngcontent-%COMP%_sparkle 1.5s ease-in-out infinite}@keyframes _ngcontent-%COMP%_sparkle{0%,to{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.2)}}"],changeDetection:0})};var Z=["popupContent"];function ee(a,e){if(a&1){let t=x();c(0,"div",2),D("click",function(o){y(t);let i=p();return b(i.onOverlayClick(o))}),c(1,"div",3,0)(3,"button",4),D("click",function(){y(t);let o=p();return b(o.onClose())}),m(4,"\xD7"),g(),c(5,"div",5),M(6,"img",6),g(),c(7,"div",7),m(8),g()()()}if(a&2){let t=p();s(),q("--origin-x",t.originX||"50vw")("--origin-y",t.originY||"50vh"),s(5),P("src",t.imagePath(),O)("alt","Day "+t.message()),s(2),S(t.message())}}var I=class a{visible=d.required();message=d.required();imagePath=d.required();originX=d();originY=d();popupContent;animationEasing="cubic-bezier(0.22, 1, 0.36, 1)";constructor(){N(()=>{let e=this.visible&&this.visible();setTimeout(e?()=>this.animateFromOrigin():()=>this.resetAnimationStyles(),0)})}close=U();onClose(){this.close.emit()}onOverlayClick(e){e.target===e.currentTarget&&this.onClose()}animateFromOrigin(){try{let e=this.popupContent?.nativeElement;if(!e)return;let o=10/(e.offsetWidth||e.getBoundingClientRect().width||300);o<=0&&(o=.01),o>1&&(o=1),e.style.transformOrigin="50% 50%",e.style.transition="none",e.style.transform=`scale(${o}) rotate(-720deg)`,e.style.opacity="0",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`transform 1.2s ${this.animationEasing}, opacity 0.6s ease`,e.style.transform="scale(1) rotate(0deg)",e.style.opacity="1"})})}catch{}}resetAnimationStyles(){try{let e=this.popupContent?.nativeElement;if(!e)return;e.style.transition="",e.style.transform="",e.style.opacity=""}catch{}}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=C({type:a,selectors:[["app-popup"]],viewQuery:function(t,n){if(t&1&&X(Z,5),t&2){let o;j(o=A())&&(n.popupContent=o.first)}},hostVars:4,hostBindings:function(t,n){t&2&&k("visible",n.visible())("hidden",!n.visible())},inputs:{visible:[1,"visible"],message:[1,"message"],imagePath:[1,"imagePath"],originX:[1,"originX"],originY:[1,"originY"]},outputs:{close:"close"},decls:1,vars:1,consts:[["popupContent",""],[1,"popup-overlay"],[1,"popup-overlay",3,"click"],[1,"popup-content"],["aria-label","Close popup",1,"close-button",3,"click"],[1,"popup-image-container"],[1,"popup-image",3,"src","alt"],[1,"popup-message"]],template:function(t,n){t&1&&u(0,ee,9,7,"div",1),t&2&&h(n.visible()?0:-1)},dependencies:[_],styles:[".popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.popup-content[_ngcontent-%COMP%]{position:relative;background:linear-gradient(135deg,#fff5f5,#ffe8e8);border-radius:12px;padding:1.25rem;max-width:90vw;max-height:90vh;box-shadow:0 8px 24px #00000040;overflow-y:auto;transform-origin:50% 50%;animation:_ngcontent-%COMP%_popupGrow .6s ease-out forwards}.close-button[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;background:#ff6b9d;color:#fff;border:none;border-radius:50%;width:2.5rem;height:2.5rem;font-size:1.5rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease;z-index:10;box-shadow:0 2px 8px #0003}.close-button[_ngcontent-%COMP%]:hover{background:#ff4d7a;transform:scale(1.1)}.close-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.popup-image-container[_ngcontent-%COMP%]{width:100%;max-width:500px;margin:0 auto 1.5rem;border-radius:15px;overflow:hidden;box-shadow:0 4px 15px #0003}.popup-image[_ngcontent-%COMP%]{width:500px;height:500px;display:block;object-fit:cover;margin:0 auto}.popup-message[_ngcontent-%COMP%]{text-align:center;font-size:1.25rem;color:#5a5a5a;font-weight:500;line-height:1.6;padding:0 1rem;white-space:pre-line;max-width:500px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_popupGrow{0%{transform:scale(.05) rotate(-180deg);opacity:0}to{transform:scale(1) rotate(0);opacity:1}}"],changeDetection:0})};var te=(a,e)=>e.day;function ne(a,e){if(a&1){let t=x();w(0,"app-window",8),L("open",function(o){let i=y(t).$implicit,r=p();return b(r.onWindowOpen(i.day,o))}),v()}if(a&2){let t=e.$implicit,n=p();V("day",t.day)("display",t.display)("isUnlocked",n.isUnlocked(t.day))("isOpened",n.isOpened(t.day))("imageUrl",n.getImageUrl(t))}}function oe(a,e){if(a&1){let t=x();w(0,"app-popup",9),L("close",function(){y(t);let o=p();return b(o.onPopupClose())}),v()}if(a&2){let t=e,n=p();V("visible",n.popupVisible())("message",t.message)("imagePath",n.getImageUrl(t))("originX",n.popupOriginX())("originY",n.popupOriginY())}}var G=class a{constructor(e,t){this.calendarDataService=e;this.cdr=t;this.loadOpenedDays(),this.refreshCalendarData(),N(()=>{let n=this.openedDays();n.size>0?localStorage.setItem("advent-calendar-opened",JSON.stringify(Array.from(n))):localStorage.removeItem("advent-calendar-opened")})}storageListener;dataUpdateListener;calendarDays=f([]);openedDays=f(new Set);selectedDay=f(null);popupVisible=f(!1);popupOriginX=f(null);popupOriginY=f(null);ngOnInit(){this.storageListener=e=>{e.key==="advent-calendar-custom-data"&&(this.refreshCalendarData(),this.cdr.markForCheck())},window.addEventListener("storage",this.storageListener),this.dataUpdateListener=()=>{this.refreshCalendarData(),this.cdr.markForCheck()},window.addEventListener("calendar-data-updated",this.dataUpdateListener)}ngOnDestroy(){this.storageListener&&window.removeEventListener("storage",this.storageListener),this.dataUpdateListener&&window.removeEventListener("calendar-data-updated",this.dataUpdateListener)}refreshCalendarData(){let e=this.calendarDataService.getAllDays(),t=this.shuffleDays(e.filter(r=>r.day>=1&&r.day<=28)),n=e.filter(r=>r.day>=29&&r.day<=32).sort((r,l)=>r.day-l.day),o=[],i=0;for(let r=0;r<4;r++)for(let l=0;l<8;l++)l<7?i<t.length&&o.push(t[i++]):o.push(n[r]);this.calendarDays.set(o)}shuffleDays(e){let t="advent-calendar-shuffle-order",n=localStorage.getItem(t),o;if(n)try{o=JSON.parse(n),o.length!==e.length&&(o=this.generateShuffleOrder(e.length),localStorage.setItem(t,JSON.stringify(o)))}catch{o=this.generateShuffleOrder(e.length),localStorage.setItem(t,JSON.stringify(o))}else o=this.generateShuffleOrder(e.length),localStorage.setItem(t,JSON.stringify(o));return o.map(i=>e[i])}generateShuffleOrder(e){let n=12345,o=()=>(n=(n*9301+49297)%233280,n/233280),i=Array.from({length:e},(r,l)=>l);for(let r=i.length-1;r>0;r--){let l=Math.floor(o()*(r+1));[i[r],i[l]]=[i[l],i[r]]}return i}loadOpenedDays(){let e=localStorage.getItem("advent-calendar-opened");if(e)try{let n=JSON.parse(e).map(o=>typeof o=="number"?o:Number(o)).filter(o=>!Number.isNaN(o));this.openedDays.set(new Set(n))}catch{this.openedDays.set(new Set)}}isUnlocked(e){let t=new Date,n=t.getFullYear(),o=new Date(n,11,1),i=new Date(o);i.setDate(o.getDate()+e-1),i.getMonth()!==11&&i.setFullYear(n+1);let r=new Date(t.getFullYear(),t.getMonth(),t.getDate());return new Date(i.getFullYear(),i.getMonth(),i.getDate())<=r}isOpened(e){return this.openedDays().has(e)}onWindowOpen(e,t){let n=this.calendarDataService.getDayData(e);if(n){let o=this.openedDays().has(e);if(!o){let i=new Set(this.openedDays());i.add(e),this.openedDays.set(i)}this.selectedDay.set(n),t?(this.popupOriginX.set(`${t.x}px`),this.popupOriginY.set(`${t.y}px`)):(this.popupOriginX.set(null),this.popupOriginY.set(null)),o?this.popupVisible.set(!0):setTimeout(()=>this.popupVisible.set(!0),900)}}onPopupClose(){this.popupVisible.set(!1),this.selectedDay.set(null)}getImageUrl(e){return this.calendarDataService.getImageUrl(e)}resetOpenedDays(){this.openedDays.set(new Set),localStorage.removeItem("advent-calendar-opened"),this.popupVisible.set(!1),this.selectedDay.set(null)}static \u0275fac=function(t){return new(t||a)(Y(J),Y($))};static \u0275cmp=C({type:a,selectors:[["app-calendar"]],decls:10,vars:1,consts:[[1,"calendar-container"],[1,"background-image"],[1,"calendar-content"],[1,"calendar-header"],[1,"gradient-text"],[1,"windows-grid"],[3,"day","display","isUnlocked","isOpened","imageUrl"],[3,"visible","message","imagePath","originX","originY"],[3,"open","day","display","isUnlocked","isOpened","imageUrl"],[3,"close","visible","message","imagePath","originX","originY"]],template:function(t,n){if(t&1&&(w(0,"div",0),W(1,"div",1),w(2,"div",2)(3,"div",3)(4,"h1",4),m(5,"Advent Calendar 2025"),v()(),w(6,"div",5),T(7,ne,1,5,"app-window",6,te),v()(),u(9,oe,1,5,"app-popup",7),v()),t&2){let o;s(7),F(n.calendarDays()),s(2),h((o=n.selectedDay())?9:-1,o)}},dependencies:[_,z,I],styles:['.calendar-container[_ngcontent-%COMP%]{position:relative;min-height:100vh;width:100%;overflow-x:hidden}.background-image[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-image:url("/advent-calendar/media/bg-img-Q5KUOFSK.jpg");background-size:cover;background-position:center;background-repeat:no-repeat;z-index:0;filter:brightness(.85) blur(2px)}.background-image[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#ffb6c14d,#ffdab94d)}.calendar-content[_ngcontent-%COMP%]{position:relative;z-index:1;padding:2rem 1rem;max-width:1400px;margin:0 auto}.calendar-header[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:2rem;flex-wrap:wrap;gap:1rem}.gradient-text[_ngcontent-%COMP%]{font-size:48px;font-weight:700;text-align:center;background:linear-gradient(90deg,#fff,#2da82d,#fff,#ff2020,#fff);background-size:300% 100%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:2px 2px 8px rgba(255,255,255,.5);animation:_ngcontent-%COMP%_gradientShift 30s linear infinite}@keyframes _ngcontent-%COMP%_gradientShift{0%{background-position:0% 50%}to{background-position:300% 50%}}.admin-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-size:1.2rem;padding:.75rem 1.5rem;background:#fff3;border-radius:10px;transition:all .3s ease;border:2px solid rgba(255,255,255,.3);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);white-space:nowrap}.admin-link[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:translateY(-2px);box-shadow:0 5px 15px #0003}.reset-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:#ff6b9dcc;border:2px solid rgba(255,255,255,.3);border-radius:10px;color:#fff;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all .3s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:0 4px 8px #0003;white-space:nowrap}.reset-button[_ngcontent-%COMP%]:hover{background:#ff6b9d;transform:translateY(-2px);box-shadow:0 6px 12px #0000004d}.reset-button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 4px #0003}.reset-button[_ngcontent-%COMP%]   .reset-icon[_ngcontent-%COMP%]{font-size:1.2rem;display:inline-block;transition:transform .3s ease}.reset-button[_ngcontent-%COMP%]:hover   .reset-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.reset-button[_ngcontent-%COMP%]   .reset-text[_ngcontent-%COMP%]{font-family:inherit}@keyframes _ngcontent-%COMP%_titleGlow{0%,to{filter:drop-shadow(0 0 10px rgba(255,107,157,.5))}50%{filter:drop-shadow(0 0 20px rgba(255,107,157,.8))}}.windows-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(8,1fr);grid-template-rows:repeat(4,1fr);gap:1rem;padding:1rem;justify-items:stretch;align-items:stretch}.windows-grid[_ngcontent-%COMP%]   app-window[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;box-sizing:border-box}'],changeDetection:0})};export{G as CalendarComponent};
